[2024-07-21 07:17:41,997] INFO [Controller id=101] 101 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2024-07-21 07:17:41,998] INFO [Controller id=101] Registering handlers (kafka.controller.KafkaController)
[2024-07-21 07:17:41,999] INFO [Controller id=101] Deleting log dir event notifications (kafka.controller.KafkaController)
[2024-07-21 07:17:41,999] INFO [Controller id=101] Deleting isr change notifications (kafka.controller.KafkaController)
[2024-07-21 07:17:42,000] INFO [Controller id=101] Initializing controller context (kafka.controller.KafkaController)
[2024-07-21 07:17:42,002] INFO [Controller id=101] Initialized broker epochs cache: HashMap(101 -> 110) (kafka.controller.KafkaController)
[2024-07-21 07:17:42,007] DEBUG [Controller id=101] Register BrokerModifications handler for Set(101) (kafka.controller.KafkaController)
[2024-07-21 07:17:42,011] DEBUG [Channel manager on controller 101]: Controller 101 trying to connect to broker 101 (kafka.controller.ControllerChannelManager)
[2024-07-21 07:17:42,013] INFO [RequestSendThread controllerId=101] Starting (kafka.controller.RequestSendThread)
[2024-07-21 07:17:42,013] INFO [Controller id=101] Currently active brokers in the cluster: Set(101) (kafka.controller.KafkaController)
[2024-07-21 07:17:42,013] INFO [Controller id=101] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-07-21 07:17:42,013] INFO [Controller id=101] Current list of topics in the cluster: HashSet(topic1) (kafka.controller.KafkaController)
[2024-07-21 07:17:42,014] INFO [Controller id=101] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2024-07-21 07:17:42,015] INFO [Controller id=101] List of topics to be deleted:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,015] INFO [Controller id=101] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,015] INFO [Controller id=101] Initializing topic deletion manager (kafka.controller.KafkaController)
[2024-07-21 07:17:42,016] INFO [Topic Deletion Manager 101] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2024-07-21 07:17:42,017] INFO [Controller id=101] Sending update metadata request (kafka.controller.KafkaController)
[2024-07-21 07:17:42,021] INFO [RequestSendThread controllerId=101] Controller 101 connected to training:9092 (id: 101 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-07-21 07:17:42,021] INFO [ReplicaStateMachine controllerId=101] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:17:42,022] INFO [ReplicaStateMachine controllerId=101] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:17:42,029] INFO [ReplicaStateMachine controllerId=101] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:17:42,030] DEBUG [ReplicaStateMachine controllerId=101] Started replica state machine with initial state -> HashMap([Topic=topic1,Partition=0,Replica=101] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:17:42,030] INFO [PartitionStateMachine controllerId=101] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:17:42,031] INFO [PartitionStateMachine controllerId=101] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:17:42,031] DEBUG [PartitionStateMachine controllerId=101] Started partition state machine with initial state -> HashMap(topic1-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:17:42,031] INFO [Controller id=101] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2024-07-21 07:17:42,033] INFO [Controller id=101] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,033] INFO [Controller id=101] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,033] INFO [Controller id=101] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,034] INFO [Controller id=101] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2024-07-21 07:17:42,034] INFO [Controller id=101] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2024-07-21 07:17:42,037] INFO [Controller id=101] Starting the controller scheduler (kafka.controller.KafkaController)
[2024-07-21 07:17:43,833] INFO [Controller id=101] Shutting down broker 101 (kafka.controller.KafkaController)
[2024-07-21 07:17:43,833] DEBUG [Controller id=101] All shutting down brokers: 101 (kafka.controller.KafkaController)
[2024-07-21 07:17:43,833] DEBUG [Controller id=101] Live brokers:  (kafka.controller.KafkaController)
[2024-07-21 07:17:43,834] TRACE [Controller id=101] All leaders = topic1-0 -> (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) (kafka.controller.KafkaController)
[2024-07-21 07:17:43,875] INFO [ControllerEventThread controllerId=101] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:17:43,876] INFO [ControllerEventThread controllerId=101] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:17:43,876] INFO [ControllerEventThread controllerId=101] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:17:43,876] DEBUG [Controller id=101] Resigning (kafka.controller.KafkaController)
[2024-07-21 07:17:43,876] DEBUG [Controller id=101] Unregister BrokerModifications handler for Set(101) (kafka.controller.KafkaController)
[2024-07-21 07:17:43,876] INFO [PartitionStateMachine controllerId=101] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:17:43,877] INFO [ReplicaStateMachine controllerId=101] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:17:43,877] INFO [RequestSendThread controllerId=101] Shutting down (kafka.controller.RequestSendThread)
[2024-07-21 07:17:43,877] INFO [RequestSendThread controllerId=101] Shutdown completed (kafka.controller.RequestSendThread)
[2024-07-21 07:17:43,877] INFO [RequestSendThread controllerId=101] Stopped (kafka.controller.RequestSendThread)
[2024-07-21 07:17:43,878] INFO [Controller id=101] Resigned (kafka.controller.KafkaController)
[2024-07-21 07:44:33,039] INFO [ControllerEventThread controllerId=101] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:44:33,051] INFO [Controller id=101] 101 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2024-07-21 07:44:33,052] INFO [Controller id=101] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2024-07-21 07:44:33,066] INFO [Controller id=101] Registering handlers (kafka.controller.KafkaController)
[2024-07-21 07:44:33,068] INFO [Controller id=101] Deleting log dir event notifications (kafka.controller.KafkaController)
[2024-07-21 07:44:33,069] INFO [Controller id=101] Deleting isr change notifications (kafka.controller.KafkaController)
[2024-07-21 07:44:33,070] INFO [Controller id=101] Initializing controller context (kafka.controller.KafkaController)
[2024-07-21 07:44:33,076] INFO [Controller id=101] Initialized broker epochs cache: HashMap(101 -> 25) (kafka.controller.KafkaController)
[2024-07-21 07:44:33,078] DEBUG [Controller id=101] Register BrokerModifications handler for Set(101) (kafka.controller.KafkaController)
[2024-07-21 07:44:33,081] DEBUG [Channel manager on controller 101]: Controller 101 trying to connect to broker 101 (kafka.controller.ControllerChannelManager)
[2024-07-21 07:44:33,084] INFO [RequestSendThread controllerId=101] Starting (kafka.controller.RequestSendThread)
[2024-07-21 07:44:33,085] INFO [Controller id=101] Currently active brokers in the cluster: Set(101) (kafka.controller.KafkaController)
[2024-07-21 07:44:33,087] INFO [Controller id=101] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-07-21 07:44:33,088] INFO [Controller id=101] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-07-21 07:44:33,088] INFO [Controller id=101] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2024-07-21 07:44:33,090] INFO [Controller id=101] List of topics to be deleted:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,091] INFO [Controller id=101] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,091] INFO [Controller id=101] Initializing topic deletion manager (kafka.controller.KafkaController)
[2024-07-21 07:44:33,091] INFO [Topic Deletion Manager 101] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2024-07-21 07:44:33,093] INFO [Controller id=101] Sending update metadata request (kafka.controller.KafkaController)
[2024-07-21 07:44:33,100] INFO [ReplicaStateMachine controllerId=101] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:44:33,100] INFO [ReplicaStateMachine controllerId=101] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:44:33,101] INFO [ReplicaStateMachine controllerId=101] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:44:33,102] DEBUG [ReplicaStateMachine controllerId=101] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2024-07-21 07:44:33,102] INFO [PartitionStateMachine controllerId=101] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:44:33,102] INFO [PartitionStateMachine controllerId=101] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:44:33,103] DEBUG [PartitionStateMachine controllerId=101] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2024-07-21 07:44:33,104] INFO [Controller id=101] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2024-07-21 07:44:33,106] WARN [RequestSendThread controllerId=101] Controller 101's connection to broker training:9092 (id: 101 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to training:9092 (id: 101 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:298)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:251)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-07-21 07:44:33,107] INFO [Controller id=101] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,107] INFO [Controller id=101] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,107] INFO [Controller id=101] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,108] INFO [Controller id=101] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2024-07-21 07:44:33,108] INFO [Controller id=101] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2024-07-21 07:44:33,116] INFO [Controller id=101] Starting the controller scheduler (kafka.controller.KafkaController)
[2024-07-21 07:44:33,208] INFO [RequestSendThread controllerId=101] Controller 101 connected to training:9092 (id: 101 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-07-21 07:44:38,117] INFO [Controller id=101] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-07-21 07:44:38,117] TRACE [Controller id=101] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-07-21 07:46:51,826] INFO [Controller id=101] Newly added brokers: 102, deleted brokers: , bounced brokers: , all live brokers: 101,102 (kafka.controller.KafkaController)
[2024-07-21 07:46:51,826] DEBUG [Channel manager on controller 101]: Controller 101 trying to connect to broker 102 (kafka.controller.ControllerChannelManager)
[2024-07-21 07:46:51,827] INFO [RequestSendThread controllerId=101] Starting (kafka.controller.RequestSendThread)
[2024-07-21 07:46:51,828] INFO [Controller id=101] New broker startup callback for 102 (kafka.controller.KafkaController)
[2024-07-21 07:46:51,829] WARN [RequestSendThread controllerId=101] Controller 101's connection to broker training:9093 (id: 102 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to training:9093 (id: 102 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:298)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:251)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-07-21 07:46:51,830] DEBUG [Controller id=101] Register BrokerModifications handler for List(102) (kafka.controller.KafkaController)
[2024-07-21 07:46:51,831] INFO [Controller id=101] Updated broker epochs cache: HashMap(101 -> 25, 102 -> 45) (kafka.controller.KafkaController)
[2024-07-21 07:46:51,844] INFO [ControllerEventThread controllerId=102] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:46:51,850] DEBUG [Controller id=102] Broker 101 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2024-07-21 07:46:51,930] INFO [RequestSendThread controllerId=101] Controller 101 connected to training:9093 (id: 102 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-07-21 07:48:48,509] INFO [Controller id=101] Newly added brokers: 103, deleted brokers: , bounced brokers: , all live brokers: 101,102,103 (kafka.controller.KafkaController)
[2024-07-21 07:48:48,509] DEBUG [Channel manager on controller 101]: Controller 101 trying to connect to broker 103 (kafka.controller.ControllerChannelManager)
[2024-07-21 07:48:48,510] INFO [RequestSendThread controllerId=101] Starting (kafka.controller.RequestSendThread)
[2024-07-21 07:48:48,510] INFO [Controller id=101] New broker startup callback for 103 (kafka.controller.KafkaController)
[2024-07-21 07:48:48,511] DEBUG [Controller id=101] Register BrokerModifications handler for List(103) (kafka.controller.KafkaController)
[2024-07-21 07:48:48,511] WARN [RequestSendThread controllerId=101] Controller 101's connection to broker training:9094 (id: 103 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to training:9094 (id: 103 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:298)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:251)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-07-21 07:48:48,512] INFO [Controller id=101] Updated broker epochs cache: HashMap(101 -> 25, 102 -> 45, 103 -> 61) (kafka.controller.KafkaController)
[2024-07-21 07:48:48,531] INFO [ControllerEventThread controllerId=103] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-07-21 07:48:48,537] DEBUG [Controller id=103] Broker 101 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2024-07-21 07:48:48,612] INFO [RequestSendThread controllerId=101] Controller 101 connected to training:9094 (id: 103 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-07-21 07:49:38,118] INFO [Controller id=101] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-07-21 07:49:38,119] TRACE [Controller id=101] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-07-21 07:54:38,119] INFO [Controller id=101] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-07-21 07:54:38,119] TRACE [Controller id=101] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-07-21 07:59:38,120] INFO [Controller id=101] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-07-21 07:59:38,120] TRACE [Controller id=101] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
